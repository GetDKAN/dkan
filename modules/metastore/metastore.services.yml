services:
  dkan.metastore.service:
    class: \Drupal\metastore\Service
    arguments:
      - '@dkan.metastore.schema_retriever'
      - '@dkan.metastore.sae_factory'
      - '@dkan.metastore.storage'

  dkan.metastore.sae_factory:
    class: \Drupal\metastore\Factory\Sae
    arguments:
      - '@dkan.metastore.schema_retriever'
      - '@dkan.metastore.storage'

  dkan.metastore.schema_retriever:
    class: \Drupal\metastore\FileSchemaRetriever
    arguments:
      - '@app.root'
      - '@extension.list.module'
    shared: false

  dkan.metastore.storage:
    class: \Drupal\metastore\Storage\NodeStorageFactory
    arguments:
      - '@entity_type.manager'

  dkan.metastore.referencer:
    class: \Drupal\metastore\Reference\Referencer
    arguments:
      - '@config.factory'
      - '@dkan.common.node_storage'
    calls:
      - [setLoggerFactory, ['@logger.factory']]

  dkan.metastore.dereferencer:
    class: \Drupal\metastore\Reference\Dereferencer
    arguments:
      - '@config.factory'
      - '@dkan.common.node_storage'
    calls:
      - [setLoggerFactory, ['@logger.factory']]

  dkan.metastore.orphan_checker:
    class: \Drupal\metastore\Reference\OrphanChecker
    arguments:
      - '@config.factory'
      - '@queue'

  dkan.metastore.resource_mapper:
    class: \Drupal\metastore\ResourceMapper
    arguments:
      - '@dkan.metastore.resource_mapper_database_table'
      - '@event_dispatcher'

  dkan.metastore.resource_mapper_database_table:
    class: \Drupal\metastore\Storage\ResourceMapperDatabaseTable
    arguments:
      - '@database'

  dkan.metastore.metastore_item_factory:
    class: \Drupal\metastore\Factory\MetastoreDataNodeFactory
    arguments:
      - '@entity.repository'
