services:
  dkan.metastore.service:
    class: \Drupal\metastore\Service
    arguments:
      - '@dkan.metastore.schema_retriever'
      - '@dkan.metastore.sae_factory'
      - '@dkan.metastore.storage'

  dkan.metastore.lifecycle:
    class: \Drupal\metastore\LifeCycle\LifeCycle
    arguments:
      - '@dkan.metastore.referencer'
      - '@dkan.metastore.dereferencer'
      - '@dkan.metastore.orphan_checker'
      - '@dkan.metastore.resource_mapper'
      - '@date.formatter'

  dkan.metastore.sae_factory:
    class: \Drupal\metastore\Factory\Sae
    arguments:
      - '@dkan.metastore.schema_retriever'
      - '@dkan.metastore.storage'

  dkan.metastore.schema_retriever:
    class: \Drupal\metastore\SchemaRetriever
    arguments:
      - '@app.root'
      - '@extension.list.module'
    shared: false

  dkan.metastore.storage:
    class: \Drupal\metastore\Storage\DataFactory
    arguments:
      - '@entity_type.manager'

  dkan.metastore.referencer:
    class: \Drupal\metastore\Reference\Referencer
    arguments:
      - '@config.factory'
      - '@dkan.metastore.storage'
    calls:
      - [setLoggerFactory, ['@logger.factory']]

  dkan.metastore.dereferencer:
    class: \Drupal\metastore\Reference\Dereferencer
    arguments:
      - '@config.factory'
      - '@dkan.metastore.storage'
    calls:
      - [setLoggerFactory, ['@logger.factory']]

  dkan.metastore.orphan_checker:
    class: \Drupal\metastore\Reference\OrphanChecker
    arguments:
      - '@config.factory'
      - '@queue'

  dkan.metastore.resource_mapper:
    class: \Drupal\metastore\ResourceMapper
    arguments:
      - '@dkan.metastore.resource_mapper_database_table'
      - '@event_dispatcher'

  dkan.metastore.resource_mapper_database_table:
    class: \Drupal\metastore\Storage\ResourceMapperDatabaseTable
    arguments:
      - '@database'

  dkan.metastore.metastore_item_factory:
    class: \Drupal\metastore\NodeWrapper\NodeDataFactory
    arguments:
      - '@entity.repository'
